import globimport osimport pandas as pdfrom clearCSV import clearCSVdef calculate_consumption():    directory_dataset_path = 'Dataset/'    csv_files = glob.glob(os.path.join(directory_dataset_path, '*.csv'))    dfs = clearCSV(csv_files)    consumption_dict = {}    for dataset in dfs:        consumption_dict[dataset] = calculate_consumption_in_time(dfs[dataset], dataset)    return consumption_dictdef calculate_consumption_in_time(consumption_per_date, name):    # Convert 'Date' column to datetime objects and set as index    consumption_per_date['Date'] = pd.to_datetime(consumption_per_date['Date'], format='%Y-%m-%d %H:%M:%S')    consumption_per_date.set_index('Date', inplace=True)    # Initialize a dictionary to hold the different consumption DataFrames    consumption_diffs = {}    # Calculate differences and format date ranges for hourly, daily, monthly, yearly    for freq in ['H', 'D', 'M', 'Y']:        diff = consumption_per_date['Kilowatt'].resample(freq).last() - consumption_per_date['Kilowatt'].resample(            freq).first()        diff = diff.reset_index()        diff['Date'] = diff['Date'].apply(lambda x: format_date_range(x, freq))        diff.rename(columns={'Kilowatt': f'{freq}_Kilowatt_Consumed'}, inplace=True)        diff.insert(0, 'ID', range(len(diff)))        consumption_diffs[freq] = diff        folder_path = f'dataset_result/kilowatt_consumption/{freq}/'        os.makedirs(folder_path, exist_ok=True)        diff.to_csv(os.path.join(folder_path, f'{name}_{freq.lower()}_consumption.csv'), index=False)    return consumption_diffs# Format datedef format_date_range(start, frequ):    if frequ == 'H':        end = start + pd.Timedelta(hours=1)        return start.strftime('%Y-%m-%d %H:00 -> ') + end.strftime('%H:00')    elif frequ == 'D':        return start.strftime('%Y-%m-%d')    elif frequ == 'M':        return start.strftime('%Y-%m')    elif frequ == 'Y':        return start.strftime('%Y')